generator dbml {
  provider              = "prisma-dbml-generator"
  output                = "../dbml"
  includeRelationFields = false
}

generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model User {
  id            String   @id
  name          String   @db.Text
  email         String
  emailVerified Boolean  @default(false)
  image         String?  @db.Text
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  batas_diskon  Decimal? // Digunakan untuk approve diskon otomatis untuk sales, dan untuk SPV/Manager

  sessions          Session[]
  accounts          Account[]
  teammembers       TeamMember[]
  members           Member[]
  invitations       Invitation[]
  suratJalans       SuratJalan[]       @relation("OverrideSuratJalan")
  prospeks          Prospek[]          @relation("ProspekSales")
  spvApprovedSPKs   SPK[]              @relation("SpvApproval")
  mgrApprovedSPKs   SPK[]              @relation("ManagerApproval")
  faktursValidated  Faktur[]           @relation("FakturValidatedBy")
  followUps         FollowUp[]         @relation("FollowUpSales")
  pelanggans        Pelanggan[]        @relation("PelangganSales")
  pembayarans       Pembayaran[]       @relation("PembayaranSales")
  dokumenKendaraans DokumenKendaraan[] @relation("DokumenUpdatedBy")
  logPersetujuans   LogPersetujuan[]   @relation("LogPersetujuanApprover")
  pembelianUnits    PembelianUnit[]    @relation("PembelianUnitCreatedBy")

  @@unique([email])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?  @db.Text
  userAgent String?  @db.Text
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  activeOrganizationId String? @db.Text
  activeTeamId         String? @db.Text

  @@unique([token])
  @@index([userId])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String    @db.Text
  providerId            String    @db.Text
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?   @db.Text
  refreshToken          String?   @db.Text
  idToken               String?   @db.Text
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?   @db.Text
  password              String?   @db.Text
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@index([userId])
  @@map("account")
}

model Verification {
  id         String   @id
  identifier String   @db.Text
  value      String   @db.Text
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@map("verification")
}

// Cabang
model Organization {
  id        String   @id
  name      String   @db.Text
  slug      String
  logo      String?  @db.Text
  createdAt DateTime @default(now())
  metadata  String?  @db.Text

  teams          Team[]
  members        Member[]
  invitations    Invitation[]
  prospeks       Prospek[]
  pembelianUnits PembelianUnit[]
  fakturs        Faktur[]
  units          Unit[]
  pembayarans    Pembayaran[]
  suratJalans    SuratJalan[]
  leasingOrders  LeasingOrder[]

  @@unique([slug])
  @@map("organization")
}

// Tim Sales
model Team {
  id             String    @id
  name           String    @db.Text
  organizationId String
  createdAt      DateTime  @default(now())
  updatedAt      DateTime? @updatedAt

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  teammembers  TeamMember[]

  @@map("team")
}

model TeamMember {
  id        String    @id
  teamId    String
  team      Team      @relation(fields: [teamId], references: [id], onDelete: Cascade)
  userId    String
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime? @default(now())

  @@index([teamId])
  @@map("team_member")
}

model Member {
  id             String       @id
  organizationId String
  organization   Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  userId         String
  user           User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  role           String       @db.Text
  createdAt      DateTime     @default(now())

  @@map("member")
}

model Invitation {
  id             String   @id
  organizationId String
  email          String   @db.Text
  role           String?  @db.Text
  teamId         String?  @db.Text
  status         String   @db.Text
  expiresAt      DateTime
  createdAt      DateTime @default(now())
  inviterId      String

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [inviterId], references: [id], onDelete: Cascade)

  @@index([email(length: 191)])
  @@map("invitation")
}

// MASTER DATA

model Kabupaten {
  id             String   @id @default(uuid()) @db.VarChar(36)
  nama_kabupaten String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  kecamatan Kecamatan[]

  @@map("kabupaten")
}

model Kecamatan {
  id             String   @id @default(uuid()) @db.VarChar(36)
  nama_kecamatan String
  kabupatenId    String   @db.VarChar(36)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  kelurahan Kelurahan[]
  kabupaten Kabupaten   @relation(fields: [kabupatenId], references: [id], onDelete: Cascade)

  @@index([kabupatenId])
  @@map("kecamatan")
}

model Kelurahan {
  id             String @id @default(uuid()) @db.VarChar(36)
  nama_kelurahan String
  kecamatanId    String @db.VarChar(36)
  latitude       Float?
  longitude      Float?

  prospek   Prospek[]
  pelanggan Pelanggan[]

  kecamatan Kecamatan @relation(fields: [kecamatanId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  spks      SPK[]

  @@index([kecamatanId])
  @@map("kelurahan")
}

model MasterModel {
  id          String  @id @default(uuid()) @db.VarChar(36)
  nama_model  String
  kategori    String
  subkategori String
  cc          Int
  series      String
  harga_otr   Decimal

  prospek          Prospek[]
  unit             Unit[]
  pembelianDetails PembelianUnitDetail[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([kategori])
  @@map("master_model")
}

model MasterWarna {
  id        String   @id @default(uuid()) @db.VarChar(36)
  warna     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  prospek          Prospek[]
  unit             Unit[]
  pembelianDetails PembelianUnitDetail[]

  @@map("master_warna")
}

enum StatusSumberProspek {
  ACTIVE
  INACTIVE
}

model SumberProspek {
  id          String              @id @default(uuid()) @db.VarChar(36)
  nama_sumber String
  status      StatusSumberProspek @default(ACTIVE)
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt

  subSumberProspek SubSumberProspek[]

  @@map("sumber_prospek")
}

model SubSumberProspek {
  id              String              @id @default(uuid()) @db.VarChar(36)
  nama_subsumber  String
  sumberProspekId String              @db.VarChar(36)
  status          StatusSumberProspek @default(ACTIVE)
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt

  prospek       Prospek[]
  sumberProspek SumberProspek @relation(fields: [sumberProspekId], references: [id], onDelete: Cascade)

  @@index([sumberProspekId])
  @@map("sub_sumber_prospek")
}

enum StatusProspek {
  BARU
  FOLLOW_UP
  PENGAJUAN_LEASING // Jika DEAL, tapi Tipe pembayarannya kredit, otomatis masuk pengajuan leasing, sebelum DEAL
  DEAL
  SPK
  GUGUR
}

enum KategoriProspek {
  HOT
  WARM
  COLD
}

model Prospek {
  id                 String          @id @default(uuid()) @db.VarChar(36)
  nama_konsumen      String
  alamat_konsumen    String?
  hp1                String
  hp2                String?
  kategori_prospek   KategoriProspek
  status             StatusProspek   @default(BARU)
  tipe_pembayaran    TipePembayaran
  tgl_perkiraan_beli DateTime?
  salesId            String
  subSumberId        String          @db.VarChar(36)
  modelId            String          @db.VarChar(36)
  warnaId            String          @db.VarChar(36)
  kelurahanId        String          @db.VarChar(36)
  deletedAt          DateTime?
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt
  cabangId           String
  spkId              String?         @unique @db.VarChar(36)
  fakturId           String?         @unique @db.VarChar(36)
  pelangganId        String?         @db.VarChar(36) // RO: jika prospek sudah pernah menjadi pelanggan, maka data pelangganId akan terisi, dan ketika prospek DEAL, otomatis dibuatkan SPK baru dengan relasi ke pelanggan yang sama

  pelanggan   Pelanggan?       @relation(fields: [pelangganId], references: [id], onDelete: SetNull)
  spk         SPK?             @relation(fields: [spkId], references: [id], onDelete: SetNull)
  cabang      Organization     @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  sales       User             @relation("ProspekSales", fields: [salesId], references: [id], onDelete: Restrict)
  subSumber   SubSumberProspek @relation(fields: [subSumberId], references: [id], onDelete: Restrict)
  model       MasterModel      @relation(fields: [modelId], references: [id], onDelete: Restrict)
  warna       MasterWarna      @relation(fields: [warnaId], references: [id], onDelete: Restrict)
  kelurahan   Kelurahan        @relation(fields: [kelurahanId], references: [id], onDelete: Restrict)
  followUps   FollowUp[]
  pembayarans Pembayaran[] // Uang titipan

  @@index([deletedAt])
  @@index([salesId])
  @@index([status])
  @@index([kelurahanId])
  @@index([subSumberId])
  @@index([modelId])
  @@index([warnaId])
  @@map("prospek")
}

enum ApprovalStatus {
  AUTO_APPROVED
  PENDING_SPV
  PENDING_MANAGER
  APPROVED
  REJECTED
}

enum TipePembayaran {
  CASH
  CREDIT
}

model SPK {
  id                      String          @id @default(uuid()) @db.VarChar(36)
  nomorSPK                String          @unique
  tanggal                 DateTime
  totalTagihan            Decimal
  totalDibayar            Decimal         @default(0)
  alamatPengiriman        String
  idKelurahanPengiriman   String          @db.VarChar(36)
  diskonPengajuan         Decimal?
  diskonDisetujui         Decimal?
  spv_approval_status     ApprovalStatus?
  spv_approval_by         String?
  spv_approval_date       DateTime?
  manager_approval_status ApprovalStatus?
  manager_approval_by     String?
  manager_approval_date   DateTime?
  pelangganId             String          @db.VarChar(36)
  unitId                  String          @unique @db.VarChar(36)
  fakturId                String?         @unique @db.VarChar(36)

  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  faktur              Faktur?          @relation(fields: [fakturId], references: [id], onDelete: SetNull)
  kelurahanPengiriman Kelurahan        @relation(fields: [idKelurahanPengiriman], references: [id], onDelete: Restrict)
  pelanggan           Pelanggan        @relation(fields: [pelangganId], references: [id], onDelete: Restrict)
  spvApprovedBy       User?            @relation("SpvApproval", fields: [spv_approval_by], references: [id], onDelete: SetNull)
  mgrApprovedBy       User?            @relation("ManagerApproval", fields: [manager_approval_by], references: [id], onDelete: SetNull)
  unit                Unit             @relation(fields: [unitId], references: [id], onDelete: Restrict)
  logApprovals        LogPersetujuan[]
  pembayaran          Pembayaran[]
  prospek             Prospek?

  @@index([deletedAt])
  @@index([pelangganId])
  @@index([unitId])
  @@index([idKelurahanPengiriman])
  @@map("spk")
}

model FollowUp {
  id        String        @id @default(uuid()) @db.VarChar(36)
  prospekId String        @db.VarChar(36)
  salesId   String
  tanggal   DateTime
  catatan   String?
  createdAt DateTime      @default(now())
  status    StatusProspek

  prospek Prospek @relation(fields: [prospekId], references: [id], onDelete: Cascade)
  sales   User    @relation("FollowUpSales", fields: [salesId], references: [id], onDelete: Restrict)

  @@index([prospekId])
  @@index([salesId])
  @@map("follow_up")
}

model Pelanggan {
  id            String    @id @default(uuid()) @db.VarChar(36)
  nama          String
  nik           String    @unique
  noHp          String
  alamatLengkap String?
  kelurahanId   String    @db.VarChar(36)
  createdById   String
  deletedAt     DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  kelurahan Kelurahan @relation(fields: [kelurahanId], references: [id], onDelete: Restrict)
  createdBy User      @relation("PelangganSales", fields: [createdById], references: [id], onDelete: Restrict)
  prospeks  Prospek[]
  spks      SPK[] // Repeat Order (RO)
  analitik  Analitik?

  @@index([deletedAt])
  @@index([nik])
  @@index([kelurahanId])
  @@index([createdById])
  @@map("pelanggan")
}

model PembelianUnit {
  id             String    @id @default(uuid()) @db.VarChar(36)
  nomorNotaDebet String    @unique
  nomorFaktur    String    @unique
  tanggalNota    DateTime
  cabangId       String
  totalUnit      Int
  createdById    String
  deletedAt      DateTime?
  createdAt      DateTime  @default(now())
  fakturId       String?   @unique @db.VarChar(36)

  faktur    Faktur?               @relation(fields: [fakturId], references: [id], onDelete: SetNull)
  cabang    Organization          @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  units     Unit[]
  createdBy User                  @relation("PembelianUnitCreatedBy", fields: [createdById], references: [id], onDelete: Restrict)
  details   PembelianUnitDetail[]

  @@index([deletedAt])
  @@index([cabangId])
  @@index([createdById])
  @@map("pembelian_unit")
}

model PembelianUnitDetail {
  id              String    @id @default(uuid()) @db.VarChar(36)
  pembelianUnitId String    @db.VarChar(36)
  modelId         String    @db.VarChar(36)
  warnaId         String    @db.VarChar(36)
  jumlah          Int
  deletedAt       DateTime?
  createdAt       DateTime  @default(now())

  pembelianUnit PembelianUnit @relation(fields: [pembelianUnitId], references: [id], onDelete: Cascade)
  model         MasterModel   @relation(fields: [modelId], references: [id], onDelete: Restrict)
  warna         MasterWarna   @relation(fields: [warnaId], references: [id], onDelete: Restrict)

  @@index([deletedAt])
  @@index([pembelianUnitId])
  @@index([modelId])
  @@index([warnaId])
  @@map("pembelian_unit_detail")
}

model LogPersetujuan {
  id            String         @id @default(uuid()) @db.VarChar(36)
  spkId         String         @db.VarChar(36)
  approverId    String
  approval_role String
  status        ApprovalStatus
  catatan       String?
  createdAt     DateTime       @default(now())

  spk      SPK  @relation(fields: [spkId], references: [id], onDelete: Cascade)
  approver User @relation("LogPersetujuanApprover", fields: [approverId], references: [id], onDelete: Restrict)

  @@index([spkId])
  @@index([approverId])
  @@map("log_persetujuan")
}

enum JenisFaktur {
  SPK
  PEMBELIAN_UNIT
  DOKUMEN_KENDARAAN
}

model Faktur {
  id            String      @id @default(uuid()) @db.VarChar(36)
  nomorFaktur   String      @unique
  tanggal       DateTime
  validatedById String
  deletedAt     DateTime?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  jenisFaktur   JenisFaktur
  cabangId      String

  cabang            Organization      @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  validatedBy       User              @relation("FakturValidatedBy", fields: [validatedById], references: [id], onDelete: Restrict)
  suratJalan        SuratJalan[]      @relation("SuratJalanFaktur")
  pembayaran        Pembayaran[]      @relation("PembayaranFaktur")
  dokumenKendaraans DokumenKendaraan?
  pembelianUnit     PembelianUnit?
  spk               SPK?

  @@index([deletedAt])
  @@index([validatedById])
  @@map("faktur")
}

model Leasing {
  id        String    @id @default(uuid()) @db.VarChar(36)
  nama      String
  kontak    String?
  deletedAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  leasingOrders LeasingOrder[] @relation("LeasingOrderLeasing")
  pembayaran    Pembayaran[]

  @@index([deletedAt])
  @@map("leasing")
}

enum StatusLeasingOrder {
  PENDING
  CAIR
  DITOLAK
}

model LeasingOrder {
  id            String             @id @default(uuid()) @db.VarChar(36)
  spkId         String             @unique @db.VarChar(36)
  leasingId     String             @db.VarChar(36)
  nomorPO       String?
  jumlahPiutang Decimal
  statusCair    StatusLeasingOrder @default(PENDING)
  tanggalCair   DateTime?
  createdAt     DateTime           @default(now()) // Tanggal pengajuan leasing
  updatedAt     DateTime           @updatedAt
  cabangId      String
  pembayaranId  String?            @unique @db.VarChar(36)

  cabang     Organization @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  leasing    Leasing      @relation("LeasingOrderLeasing", fields: [leasingId], references: [id], onDelete: Restrict)
  pembayaran Pembayaran?  @relation(fields: [pembayaranId], references: [id], onDelete: SetNull)

  @@index([spkId])
  @@index([leasingId])
  @@index([cabangId])
  @@index([pembayaranId])
  @@map("leasing_order")
}

enum StatusUnit {
  // IN_TRANSIT: unit sudah keluar dari pabrik, tapi belum sampai ke dealer. tidak perlu disimpan di database, karena tidak memiliki informasi seperti nomor rangka, nomor mesin, dll 
  GUDANG // Unit sudah sampai di dealer, siap untuk PDC (Pre Delivery Checking)
  PDC // Unit sedang dalam proses PDC
  NRFS // Not Ready For Sale: unit tidak lulus PDC
  SHOWROOM // Unit tersedia di showroom
  BOOKED // Unit telah dipesan
  SOLD // Unit telah terjual
}

model Unit {
  id              String     @id @default(uuid()) @db.VarChar(36)
  nomorRangka     String     @unique
  nomorMesin      String     @unique
  tahun           Int
  status          StatusUnit
  modelId         String     @db.VarChar(36)
  warnaId         String     @db.VarChar(36)
  pembelianUnitId String     @db.VarChar(36)
  deletedAt       DateTime?
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
  cabangId        String

  cabang        Organization      @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  model         MasterModel       @relation(fields: [modelId], references: [id], onDelete: Restrict)
  warna         MasterWarna       @relation(fields: [warnaId], references: [id], onDelete: Restrict)
  pembelianUnit PembelianUnit     @relation(fields: [pembelianUnitId], references: [id], onDelete: Restrict)
  spk           SPK?
  dokumen       DokumenKendaraan?

  @@index([deletedAt])
  @@index([status])
  @@index([nomorRangka])
  @@index([nomorMesin])
  @@index([modelId])
  @@index([warnaId])
  @@index([cabangId])
  @@map("unit")
}

enum StatusPengiriman {
  DIPROSES
  DIKIRIM
  DITERIMA
}

model SuratJalan {
  id              String           @id @default(uuid()) @db.VarChar(36)
  nomorSuratJalan String           @unique
  fakturId        String           @unique @db.VarChar(36)
  isOverridden    Boolean          @default(false)
  overrideById    String?
  overrideReason  String?
  status          StatusPengiriman @default(DIPROSES)
  tanggalKirim    DateTime?
  tanggalTerima   DateTime?
  deletedAt       DateTime?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  cabangId        String

  faktur       Faktur       @relation("SuratJalanFaktur", fields: [fakturId], references: [id], onDelete: Cascade)
  overriddenBy User?        @relation("OverrideSuratJalan", fields: [overrideById], references: [id], onDelete: SetNull)
  cabang       Organization @relation(fields: [cabangId], references: [id], onDelete: Restrict)

  @@index([overrideById])
  @@index([deletedAt])
  @@index([fakturId])
  @@index([cabangId])
  @@map("surat_jalan")
}

enum JenisPembayaran {
  UANG_TITIPAN
  DP
  PELUNASAN
}

enum MetodePembayaran {
  CASH
  TRANSFER
}

model Pembayaran {
  id          String           @id @default(uuid()) @db.VarChar(36)
  prospekId   String?          @db.VarChar(36)
  fakturId    String?          @db.VarChar(36)
  leasingId   String?          @db.VarChar(36)
  jumlah      Decimal
  jenis       JenisPembayaran
  metode      MetodePembayaran
  buktiBayar  String?
  createdById String
  deletedAt   DateTime?
  createdAt   DateTime         @default(now()) // Tanggal bayar
  updatedAt   DateTime         @updatedAt
  cabangId    String

  cabang       Organization  @relation(fields: [cabangId], references: [id], onDelete: Restrict)
  propek       Prospek?      @relation(fields: [prospekId], references: [id], onDelete: Cascade)
  faktur       Faktur?       @relation("PembayaranFaktur", fields: [fakturId], references: [id], onDelete: SetNull)
  leasing      Leasing?      @relation(fields: [leasingId], references: [id], onDelete: SetNull)
  createdBy    User          @relation("PembayaranSales", fields: [createdById], references: [id], onDelete: Restrict)
  leasingOrder LeasingOrder?
  spk          SPK?          @relation(fields: [sPKId], references: [id])
  sPKId        String?       @db.VarChar(36)

  @@index([deletedAt])
  @@index([prospekId])
  @@index([fakturId])
  @@index([createdById])
  @@map("pembayaran")
}

enum StatusDokumen {
  PENDING_FAKTUR
  PROSES_SAMSAT
  STNK_DITERIMA
  STNK_DISERAHKAN
  BPKB_DITERIMA
  BPKB_DISERAHKAN
}

model DokumenKendaraan {
  id                          String        @id @default(uuid()) @db.VarChar(36)
  unitId                      String        @unique @db.VarChar(36)
  tglFakturMainDealer         DateTime?
  tglFakturMainDealerDiterima DateTime?
  tglPengajuanSamsat          DateTime?
  tglStnkDiterima             DateTime?
  tglStnkDiserahkan           DateTime?
  tglBpkbDiterima             DateTime?
  tglBpkbDiserahkan           DateTime?
  noPolisi                    String?
  nomorBpkb                   String?
  status                      StatusDokumen @default(PENDING_FAKTUR)
  deletedAt                   DateTime?
  createdAt                   DateTime      @default(now())
  updatedAt                   DateTime      @updatedAt
  updatedById                 String?
  fakturId                    String?       @unique @db.VarChar(36)

  unit      Unit    @relation(fields: [unitId], references: [id], onDelete: Cascade)
  updatedBy User?   @relation("DokumenUpdatedBy", fields: [updatedById], references: [id], onDelete: SetNull)
  faktur    Faktur? @relation(fields: [fakturId], references: [id], onDelete: SetNull)

  @@index([deletedAt])
  @@index([unitId])
  @@index([updatedById])
  @@map("dokumen_kendaraan")
}

enum LoyaltyCluster {
  LOYAL
  POTENTIAL
  STANDARD
  AT_RISK
  DORMANT
}

enum ProductSegment {
  Matic
  Sport
  Cub
  Listrik
}

model Analitik {
  id             String         @id @default(uuid()) @db.VarChar(36)
  pelangganId    String         @unique @db.VarChar(36)
  rfts_recency   Int
  rfts_frequency Int
  rfts_tenure    Int
  rfts_segment   ProductSegment
  clusterLabel   LoyaltyCluster
  deletedAt      DateTime?
  updatedAt      DateTime       @updatedAt

  pelanggan Pelanggan @relation(fields: [pelangganId], references: [id], onDelete: Cascade)

  @@index([deletedAt])
  @@index([pelangganId])
  @@index([clusterLabel])
  @@index([rfts_segment])
  @@map("analitik")
}
